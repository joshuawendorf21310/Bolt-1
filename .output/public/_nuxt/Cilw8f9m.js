import{j as ns,G as os,c as i,a as s,d as P,F as y,s as g,n as o,m as v,y as q,p as Y,t as a,q as r,a0 as z,v as is,l as j,r as u,o as l,B as _,C as ls,J as S,_ as ds}from"./Ys5eufZ_.js";import{u as rs}from"./whLkva8r.js";const us={class:"trades-container"},ps={class:"page-header"},cs={class:"trades-tabs"},fs=["onClick"],vs={key:0,class:"tab-badge"},_s={class:"trades-filters"},ms={class:"filter-group"},hs={class:"filter-stats"},ys={class:"stat-item"},gs={class:"stat-value"},bs={class:"stat-item"},ks={class:"stat-value"},Ts={class:"trades-content"},Ss={key:0,class:"marketplace-grid"},Cs={class:"trade-header"},ws={class:"trade-date"},$s={class:"trade-shift-info"},Ds={class:"shift-detail"},Us={class:"shift-name"},As={class:"shift-time"},qs={class:"shift-station"},Ms={key:0,class:"shift-detail"},Is={key:1,class:"shift-detail"},xs={class:"shift-placeholder"},Os={key:0,class:"trade-reason"},Vs={class:"reason-text"},Ns={class:"trade-footer"},Ls={class:"trade-user"},Rs={class:"user-avatar"},Ys={class:"user-name"},zs=["onClick"],Bs={key:1,class:"my-trade-badge"},Gs={key:0,class:"empty-state"},Es={key:1,class:"trades-list"},Fs={class:"trade-content"},Ps={class:"trade-list-header"},js={class:"trade-shifts"},Ws={class:"offering-shift"},Hs={class:"shift-info"},Js={class:"shift-date"},Ks={class:"shift-time"},Qs={class:"shift-station"},Xs={key:0,class:"requesting-shift"},Zs={class:"shift-info"},st={class:"user-name"},tt={key:0,class:"shift-date"},et={class:"trade-actions"},at={class:"trade-time"},nt={class:"action-buttons"},ot=["onClick"],it=["onClick"],lt=["onClick"],dt={key:0,class:"empty-state"},rt={key:2,class:"trades-list"},ut={class:"trade-content"},pt={class:"trade-approval-header"},ct={class:"participants"},ft={class:"participant"},vt={class:"participant-name"},_t={class:"participant"},mt={class:"participant-name"},ht={class:"trade-details-grid"},yt={class:"detail-card"},gt={class:"card-date"},bt={class:"card-time"},kt={class:"card-station"},Tt={key:0,class:"detail-card"},St={class:"card-date"},Ct={class:"card-time"},wt={class:"card-station"},$t={key:0,class:"trade-reason-box"},Dt={class:"reason-text"},Ut={class:"approval-footer"},At={class:"trade-time"},qt={class:"approval-buttons"},Mt=["onClick"],It=["onClick"],xt={key:0,class:"empty-state"},Ot={key:3,class:"trades-list"},Vt={class:"trade-content"},Nt={class:"trade-list-header"},Lt={class:"participants-inline"},Rt={class:"trade-summary"},Yt={class:"trade-completed-date"},zt={class:"modal-header"},Bt={class:"modal-body"},Gt={class:"form-group"},Et=["value"],Ft={class:"form-group"},Pt={class:"trade-type-options"},jt={class:"radio-option"},Wt={class:"radio-option"},Ht={class:"radio-option"},Jt={class:"form-group"},Kt={class:"modal-footer"},Qt=["disabled"],Xt={class:"modal-header"},Zt={class:"modal-body"},se={class:"accept-summary"},te={class:"trade-preview"},ee={class:"preview-shift"},ae={class:"preview-details"},ne={key:0,class:"form-group"},oe=["value"],ie={class:"modal-footer"},le=["disabled"],de=ns({__name:"trades",setup(re){const M=u("org-123"),C=useShiftTrades(),W=useScheduling(),I=rs(),w=u("marketplace"),$=u(""),D=u(""),x=u(!0),b=u([]),O=u([]),m=u(!1),k=u(!1),p=u(null),T=u(""),d=u({shiftId:"",tradeType:"swap",reason:""}),H=S(()=>{const n=[{key:"marketplace",label:"Marketplace",count:B.value.length},{key:"my-trades",label:"My Trades",count:A.value.length}];return x.value&&n.push({key:"pending-approval",label:"Pending Approval",count:V.value.length}),n.push({key:"history",label:"History",count:null}),n}),B=S(()=>b.value.filter(n=>n.status==="pending")),A=S(()=>{const n=I.getUser();return n?b.value.filter(t=>(t.offering_user_id===n.id||t.requesting_user_id===n.id)&&!["management_approved","management_denied","cancelled"].includes(t.status)):[]}),V=S(()=>b.value.filter(n=>n.status==="accepted")),J=S(()=>b.value.filter(n=>["management_approved","management_denied","cancelled"].includes(n.status))),G=S(()=>B.value.filter(n=>!($.value&&n.trade_type!==$.value||D.value&&n.offering_shift?.station!==D.value))),U=async()=>{const n=await I.getUser();if(!n)return;const t=new Date().toISOString().split("T")[0],e=new Date;e.setMonth(e.getMonth()+3);const f=e.toISOString().split("T")[0],[es,as]=await Promise.all([C.getShiftTrades(M.value),W.getScheduledShifts(M.value,t,f)]);b.value=es,O.value=as.filter(R=>R.user_id===n.id&&R.status==="scheduled"&&R.shift_date>=t)},E=()=>{},K=async()=>{(await C.offerShiftTrade({organizationId:M.value,offeringShiftId:d.value.shiftId,tradeType:d.value.tradeType,reason:d.value.reason||void 0})).success&&(m.value=!1,d.value={shiftId:"",tradeType:"swap",reason:""},U())},Q=n=>{p.value=n,T.value="",k.value=!0},X=async()=>{if(!p.value)return;(await C.acceptShiftTrade(p.value.id,T.value||void 0)).success&&(k.value=!1,p.value=null,U())},Z=async n=>{confirm("Are you sure you want to cancel this trade?")&&(await C.cancelShiftTrade(n,"Cancelled by user"),U())},N=async(n,t,e)=>{await C.approveShiftTrade(n,t,e),U()},F=(n,t)=>{const e=t==="approve";N(n.id,e)},ss=n=>{const t=I.getUser();return t&&n.offering_user_id===t.id},ts=n=>n?n.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"?",c=n=>n?new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",L=n=>n?new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"",h=n=>{if(!n)return"";const t=new Date(n.start_time),e=new Date(n.end_time);return`${t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})} - ${e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}`};return os(()=>{U()}),(n,t)=>(l(),i("div",us,[s("div",ps,[t[19]||(t[19]=s("div",{class:"header-content"},[s("h1",null,"Shift Trading Marketplace"),s("p",{class:"subtitle"},"Trade, swap, or cover shifts with your team")],-1)),s("button",{onClick:t[0]||(t[0]=e=>m.value=!0),class:"btn-primary"},[...t[18]||(t[18]=[s("span",{class:"icon"},"+",-1),P(" Offer Shift ",-1)])])]),s("div",cs,[(l(!0),i(y,null,g(o(H),e=>(l(),i("button",{key:e.key,onClick:f=>w.value=e.key,class:_(["tab-btn",{active:o(w)===e.key}])},[P(a(e.label)+" ",1),e.count?(l(),i("span",vs,a(e.count),1)):r("",!0)],10,fs))),128))]),s("div",_s,[s("div",ms,[v(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>Y($)?$.value=e:null),class:"filter-select",onChange:E},[...t[20]||(t[20]=[s("option",{value:""},"All Types",-1),s("option",{value:"swap"},"Swap",-1),s("option",{value:"giveaway"},"Giveaway",-1),s("option",{value:"cover"},"Cover",-1)])],544),[[q,o($)]]),v(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>Y(D)?D.value=e:null),class:"filter-select",onChange:E},[...t[21]||(t[21]=[s("option",{value:""},"All Stations",-1),s("option",{value:"Station 1"},"Station 1",-1),s("option",{value:"Station 2"},"Station 2",-1),s("option",{value:"Station 3"},"Station 3",-1)])],544),[[q,o(D)]])]),s("div",hs,[s("div",ys,[s("span",gs,a(o(b).length),1),t[22]||(t[22]=s("span",{class:"stat-label"},"Active Trades",-1))]),s("div",bs,[s("span",ks,a(o(A).length),1),t[23]||(t[23]=s("span",{class:"stat-label"},"My Trades",-1))])])]),s("div",Ts,[o(w)==="marketplace"?(l(),i("div",Ss,[(l(!0),i(y,null,g(o(G),e=>(l(),i("div",{key:e.id,class:"trade-card"},[s("div",Cs,[s("div",{class:_(["trade-type-badge",`type-${e.trade_type}`])},a(e.trade_type),3),s("div",ws,a(c(e.offering_shift?.shift_date)),1)]),s("div",$s,[s("div",Ds,[t[24]||(t[24]=s("span",{class:"detail-label"},"Offering:",-1)),s("div",{class:"shift-block",style:ls({backgroundColor:e.offering_shift?.template?.color_code||"#ff6b00"})},[s("span",Us,a(e.offering_shift?.template?.template_name||"Shift"),1),s("span",As,a(h(e.offering_shift)),1),s("span",qs,a(e.offering_shift?.station||"No Station"),1)],4)]),t[27]||(t[27]=s("div",{class:"shift-separator"},"â‡„",-1)),e.trade_type==="swap"?(l(),i("div",Ms,[...t[25]||(t[25]=[s("span",{class:"detail-label"},"Looking for:",-1),s("div",{class:"shift-placeholder"},[s("span",null,"Any compatible shift")],-1)])])):(l(),i("div",Is,[t[26]||(t[26]=s("span",{class:"detail-label"},"Need:",-1)),s("div",xs,[s("span",null,a(e.trade_type==="giveaway"?"Someone to take":"Coverage"),1)])]))]),e.reason?(l(),i("div",Os,[t[28]||(t[28]=s("span",{class:"reason-icon"},"ðŸ’¬",-1)),s("span",Vs,a(e.reason),1)])):r("",!0),s("div",Ns,[s("div",Ls,[s("span",Rs,a(ts(e.offering_user?.full_name)),1),s("span",Ys,a(e.offering_user?.full_name),1)]),ss(e)?(l(),i("span",Bs,"Your Trade")):(l(),i("button",{key:0,onClick:f=>Q(e),class:"btn-accept"}," Accept Trade ",8,zs))])]))),128)),o(G).length===0?(l(),i("div",Gs,[t[29]||(t[29]=s("div",{class:"empty-icon"},"ðŸ”„",-1)),t[30]||(t[30]=s("h3",null,"No Available Trades",-1)),t[31]||(t[31]=s("p",null,"There are no shifts available for trading right now.",-1)),s("button",{onClick:t[3]||(t[3]=e=>m.value=!0),class:"btn-primary"}," Offer a Shift ")])):r("",!0)])):o(w)==="my-trades"?(l(),i("div",Es,[(l(!0),i(y,null,g(o(A),e=>(l(),i("div",{key:e.id,class:_(["trade-list-item",`status-${e.status}`])},[t[34]||(t[34]=s("div",{class:"trade-status-bar"},null,-1)),s("div",Fs,[s("div",Ps,[s("div",{class:_(["trade-type-badge",`type-${e.trade_type}`])},a(e.trade_type),3),s("span",{class:_(["status-badge",`status-${e.status}`])},a(e.status.replace("_"," ")),3)]),s("div",js,[s("div",Ws,[t[32]||(t[32]=s("span",{class:"shift-label"},"Offering:",-1)),s("div",Hs,[s("span",Js,a(c(e.offering_shift?.shift_date)),1),s("span",Ks,a(h(e.offering_shift)),1),s("span",Qs,a(e.offering_shift?.station),1)])]),e.requesting_user?(l(),i("div",Xs,[t[33]||(t[33]=s("span",{class:"shift-label"},"With:",-1)),s("div",Zs,[s("span",st,a(e.requesting_user?.full_name),1),e.requesting_shift?(l(),i("span",tt,a(c(e.requesting_shift?.shift_date)),1)):r("",!0)])])):r("",!0)]),s("div",et,[s("span",at,a(L(e.offered_at)),1),s("div",nt,[e.status==="pending"?(l(),i("button",{key:0,onClick:f=>Z(e.id),class:"btn-cancel"}," Cancel ",8,ot)):r("",!0),e.status==="accepted"&&o(x)?(l(),i("button",{key:1,onClick:f=>F(e,"approve"),class:"btn-approve"}," Approve ",8,it)):r("",!0),e.status==="accepted"&&o(x)?(l(),i("button",{key:2,onClick:f=>F(e,"deny"),class:"btn-deny"}," Deny ",8,lt)):r("",!0)])])])],2))),128)),o(A).length===0?(l(),i("div",dt,[...t[35]||(t[35]=[s("div",{class:"empty-icon"},"ðŸ“‹",-1),s("h3",null,"No Active Trades",-1),s("p",null,"You don't have any shift trades in progress.",-1)])])):r("",!0)])):o(w)==="pending-approval"?(l(),i("div",rt,[(l(!0),i(y,null,g(o(V),e=>(l(),i("div",{key:e.id,class:"trade-list-item approval-card"},[t[42]||(t[42]=s("div",{class:"trade-status-bar"},null,-1)),s("div",ut,[s("div",pt,[s("div",ct,[s("div",ft,[t[36]||(t[36]=s("span",{class:"participant-label"},"From:",-1)),s("span",vt,a(e.offering_user?.full_name),1)]),t[38]||(t[38]=s("span",{class:"separator"},"â†”",-1)),s("div",_t,[t[37]||(t[37]=s("span",{class:"participant-label"},"To:",-1)),s("span",mt,a(e.requesting_user?.full_name),1)])]),s("div",{class:_(["trade-type-badge",`type-${e.trade_type}`])},a(e.trade_type),3)]),s("div",ht,[s("div",yt,[t[39]||(t[39]=s("span",{class:"card-label"},"Offering Shift",-1)),s("span",gt,a(c(e.offering_shift?.shift_date)),1),s("span",bt,a(h(e.offering_shift)),1),s("span",kt,a(e.offering_shift?.station),1)]),e.requesting_shift?(l(),i("div",Tt,[t[40]||(t[40]=s("span",{class:"card-label"},"Requesting Shift",-1)),s("span",St,a(c(e.requesting_shift?.shift_date)),1),s("span",Ct,a(h(e.requesting_shift)),1),s("span",wt,a(e.requesting_shift?.station),1)])):r("",!0)]),e.reason?(l(),i("div",$t,[t[41]||(t[41]=s("span",{class:"reason-label"},"Reason:",-1)),s("span",Dt,a(e.reason),1)])):r("",!0),s("div",Ut,[s("span",At,"Requested "+a(L(e.accepted_at)),1),s("div",qt,[s("button",{onClick:f=>N(e.id,!1,"Denied by management"),class:"btn-deny"}," Deny ",8,Mt),s("button",{onClick:f=>N(e.id,!0),class:"btn-approve"}," Approve Trade ",8,It)])])])]))),128)),o(V).length===0?(l(),i("div",xt,[...t[43]||(t[43]=[s("div",{class:"empty-icon"},"âœ…",-1),s("h3",null,"All Caught Up!",-1),s("p",null,"No trades waiting for approval.",-1)])])):r("",!0)])):(l(),i("div",Ot,[(l(!0),i(y,null,g(o(J),e=>(l(),i("div",{key:e.id,class:_(["trade-list-item",`status-${e.status}`])},[t[45]||(t[45]=s("div",{class:"trade-status-bar"},null,-1)),s("div",Vt,[s("div",Nt,[s("div",Lt,[s("span",null,a(e.offering_user?.full_name),1),t[44]||(t[44]=s("span",{class:"separator"},"â†’",-1)),s("span",null,a(e.requesting_user?.full_name),1)]),s("span",{class:_(["status-badge",`status-${e.status}`])},a(e.status.replace("_"," ")),3)]),s("div",Rt,[s("span",null,a(e.trade_type)+" â€¢ "+a(c(e.offering_shift?.shift_date)),1)]),s("div",Yt," Completed "+a(L(e.completed_at||e.updated_at)),1)])],2))),128))]))]),o(m)?(l(),i("div",{key:0,class:"modal-overlay",onClick:t[12]||(t[12]=e=>m.value=!1)},[s("div",{class:"modal-content",onClick:t[11]||(t[11]=j(()=>{},["stop"]))},[s("div",zt,[t[46]||(t[46]=s("h2",null,"Offer Shift for Trade",-1)),s("button",{onClick:t[4]||(t[4]=e=>m.value=!1),class:"btn-close"},"Ã—")]),s("div",Bt,[s("div",Gt,[t[48]||(t[48]=s("label",null,"Select Your Shift",-1)),v(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>o(d).shiftId=e),class:"form-select"},[t[47]||(t[47]=s("option",{value:""},"Choose a shift...",-1)),(l(!0),i(y,null,g(o(O),e=>(l(),i("option",{key:e.id,value:e.id},a(c(e.shift_date))+" - "+a(h(e))+" ("+a(e.station)+") ",9,Et))),128))],512),[[q,o(d).shiftId]])]),s("div",Ft,[t[52]||(t[52]=s("label",null,"Trade Type",-1)),s("div",Pt,[s("label",jt,[v(s("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=e=>o(d).tradeType=e),value:"swap"},null,512),[[z,o(d).tradeType]]),t[49]||(t[49]=s("div",{class:"option-content"},[s("span",{class:"option-title"},"Swap"),s("span",{class:"option-desc"},"Exchange shifts with another employee")],-1))]),s("label",Wt,[v(s("input",{type:"radio","onUpdate:modelValue":t[7]||(t[7]=e=>o(d).tradeType=e),value:"giveaway"},null,512),[[z,o(d).tradeType]]),t[50]||(t[50]=s("div",{class:"option-content"},[s("span",{class:"option-title"},"Giveaway"),s("span",{class:"option-desc"},"Give your shift to someone else")],-1))]),s("label",Ht,[v(s("input",{type:"radio","onUpdate:modelValue":t[8]||(t[8]=e=>o(d).tradeType=e),value:"cover"},null,512),[[z,o(d).tradeType]]),t[51]||(t[51]=s("div",{class:"option-content"},[s("span",{class:"option-title"},"Cover"),s("span",{class:"option-desc"},"Need someone to cover part of your shift")],-1))])])]),s("div",Jt,[t[53]||(t[53]=s("label",null,"Reason (Optional)",-1)),v(s("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>o(d).reason=e),class:"form-textarea",rows:"3",placeholder:"Why do you need to trade this shift?"},null,512),[[is,o(d).reason]])])]),s("div",Kt,[s("button",{onClick:t[10]||(t[10]=e=>m.value=!1),class:"btn-secondary"}," Cancel "),s("button",{onClick:K,class:"btn-primary",disabled:!o(d).shiftId}," Post Trade Offer ",8,Qt)])])])):r("",!0),o(k)?(l(),i("div",{key:1,class:"modal-overlay",onClick:t[17]||(t[17]=e=>k.value=!1)},[s("div",{class:"modal-content",onClick:t[16]||(t[16]=j(()=>{},["stop"]))},[s("div",Xt,[t[54]||(t[54]=s("h2",null,"Accept Trade",-1)),s("button",{onClick:t[13]||(t[13]=e=>k.value=!1),class:"btn-close"},"Ã—")]),s("div",Zt,[s("div",se,[t[56]||(t[56]=s("h3",null,"You're accepting this trade:",-1)),s("div",te,[s("div",ee,[t[55]||(t[55]=s("span",{class:"preview-label"},"Their Shift:",-1)),s("div",ae,[s("span",null,a(c(o(p)?.offering_shift?.shift_date)),1),s("span",null,a(h(o(p)?.offering_shift)),1),s("span",null,a(o(p)?.offering_shift?.station),1)])])])]),o(p)?.trade_type==="swap"?(l(),i("div",ne,[t[58]||(t[58]=s("label",null,"Select Your Shift to Exchange",-1)),v(s("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>Y(T)?T.value=e:null),class:"form-select"},[t[57]||(t[57]=s("option",{value:""},"Choose a shift...",-1)),(l(!0),i(y,null,g(o(O),e=>(l(),i("option",{key:e.id,value:e.id},a(c(e.shift_date))+" - "+a(h(e))+" ("+a(e.station)+") ",9,oe))),128))],512),[[q,o(T)]])])):r("",!0),t[59]||(t[59]=s("div",{class:"trade-notice"},[s("span",{class:"notice-icon"},"â„¹ï¸"),s("span",{class:"notice-text"}," This trade requires management approval before it takes effect. ")],-1))]),s("div",ie,[s("button",{onClick:t[15]||(t[15]=e=>k.value=!1),class:"btn-secondary"}," Cancel "),s("button",{onClick:X,class:"btn-primary",disabled:o(p)?.trade_type==="swap"&&!o(T)}," Confirm Trade ",8,le)])])])):r("",!0)]))}}),ce=ds(de,[["__scopeId","data-v-be42500f"]]);export{ce as default};

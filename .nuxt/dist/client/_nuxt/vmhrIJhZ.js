import{j as S,G as D,c as l,a as s,n as e,F as P,s as C,t as a,q as d,l as I,r as m,o,B as M,_ as B}from"./Ys5eufZ_.js";import{u as F}from"./Bo8boqc2.js";const T={class:"patient-portal"},x={key:0,class:"loading-state"},A={key:1,class:"empty-state"},N={key:2,class:"invoices-list"},U=["onClick"],j={class:"invoice-header"},L={class:"invoice-number"},V={class:"invoice-details"},Y={class:"detail-row"},E={class:"detail-row"},$={class:"detail-row"},q={class:"amount-due"},z={key:0,class:"pay-button"},G={class:"modal-body"},R={key:0,class:"statement-section"},W={class:"statement-content"},H={class:"statement-row"},J={class:"statement-row"},K={key:0,class:"statement-row"},O={key:1,class:"statement-row"},Q={class:"charges-breakdown"},X={class:"charge-row"},Z={class:"charge-row"},ss={key:0,class:"charge-row"},ts={class:"charge-row total"},es={key:1,class:"payment-plan-section"},ns={class:"plan-details"},as={class:"plan-row"},ls={class:"plan-row"},os={class:"plan-row"},is={class:"modal-footer"},rs=["href"],ds=S({__name:"bills",setup(us){const{getInvoicesByEmail:f,getInvoiceDetails:g}=F(),_=useSupabaseUser(),c=m([]),u=m(null),n=m({}),v=m(!0),p=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(i/100),y=i=>new Date(i).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),w=i=>({unpaid:"Unpaid",paid:"Paid",failed:"Payment Failed",disputed:"Disputed"})[i]||i,k=i=>({ambulance_transport:"Ambulance Transport",telehealth:"Telehealth Service"})[i]||i,h=async i=>{u.value=i,n.value=await g(i.id)},b=()=>{u.value=null,n.value={}};return D(async()=>{_.value?.email&&(c.value=await f(_.value.email)),v.value=!1}),(i,t)=>(o(),l("div",T,[t[21]||(t[21]=s("div",{class:"portal-header"},[s("h1",null,"Your Bills"),s("p",{class:"subtitle"},"View and pay your ambulance and telehealth bills securely")],-1)),e(v)?(o(),l("div",x,[...t[1]||(t[1]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading your bills...",-1)])])):e(c).length===0?(o(),l("div",A,[...t[2]||(t[2]=[s("p",null,"You have no bills at this time.",-1)])])):(o(),l("div",N,[(o(!0),l(P,null,C(e(c),r=>(o(),l("div",{key:r.id,class:"invoice-card",onClick:ps=>h(r)},[s("div",j,[s("span",L,a(r.invoice_number),1),s("span",{class:M(["status-badge",`status-${r.payment_status}`])},a(w(r.payment_status)),3)]),s("div",V,[s("div",Y,[t[3]||(t[3]=s("span",{class:"label"},"Service Type:",-1)),s("span",null,a(k(r.service_type)),1)]),s("div",E,[t[4]||(t[4]=s("span",{class:"label"},"Due Date:",-1)),s("span",null,a(y(r.due_date)),1)]),s("div",$,[t[5]||(t[5]=s("span",{class:"label"},"Amount Due:",-1)),s("span",q,a(p(r.amount_outstanding)),1)])]),r.payment_status==="unpaid"?(o(),l("button",z," Pay Now ")):d("",!0)],8,U))),128))])),e(u)?(o(),l("div",{key:3,class:"modal-overlay",onClick:b},[s("div",{class:"modal",onClick:t[0]||(t[0]=I(()=>{},["stop"]))},[s("div",{class:"modal-header"},[t[6]||(t[6]=s("h2",null,"Bill Details",-1)),s("button",{onClick:b,class:"close-button"},"Ã—")]),s("div",G,[e(n).statement?(o(),l("div",R,[t[15]||(t[15]=s("h3",null,"Statement of Services",-1)),s("div",W,[s("div",H,[t[7]||(t[7]=s("span",{class:"label"},"Service Date:",-1)),s("span",null,a(y(e(n).statement.service_date)),1)]),s("div",J,[t[8]||(t[8]=s("span",{class:"label"},"Service Description:",-1)),s("span",null,a(e(n).statement.service_description),1)]),e(n).statement.origin_address?(o(),l("div",K,[t[9]||(t[9]=s("span",{class:"label"},"From:",-1)),s("span",null,a(e(n).statement.origin_address),1)])):d("",!0),e(n).statement.destination_address?(o(),l("div",O,[t[10]||(t[10]=s("span",{class:"label"},"To:",-1)),s("span",null,a(e(n).statement.destination_address),1)])):d("",!0)]),s("div",Q,[s("div",X,[t[11]||(t[11]=s("span",null,"Total Charge",-1)),s("span",null,a(p(e(n).statement.total_charge)),1)]),s("div",Z,[t[12]||(t[12]=s("span",null,"Insurance Payment",-1)),s("span",null,"-"+a(p(e(n).statement.insurance_payment)),1)]),e(n).statement.adjustments>0?(o(),l("div",ss,[t[13]||(t[13]=s("span",null,"Adjustments",-1)),s("span",null,"-"+a(p(e(n).statement.adjustments)),1)])):d("",!0),s("div",ts,[t[14]||(t[14]=s("span",null,"Your Responsibility",-1)),s("span",null,a(p(e(n).statement.patient_balance)),1)])])])):d("",!0),e(n).paymentPlan?(o(),l("div",es,[t[19]||(t[19]=s("h3",null,"Payment Plan",-1)),s("div",ns,[s("div",as,[t[16]||(t[16]=s("span",null,"Installment Amount:",-1)),s("span",null,a(p(e(n).paymentPlan.installment_amount)),1)]),s("div",ls,[t[17]||(t[17]=s("span",null,"Payments Made:",-1)),s("span",null,a(e(n).paymentPlan.installments_paid)+" of "+a(e(n).paymentPlan.installments_total),1)]),s("div",os,[t[18]||(t[18]=s("span",null,"Next Payment:",-1)),s("span",null,a(y(e(n).paymentPlan.next_payment_date)),1)])])])):d("",!0)]),s("div",is,[e(u).stripe_hosted_url&&e(u).payment_status==="unpaid"?(o(),l("a",{key:0,href:e(u).stripe_hosted_url,target:"_blank",class:"stripe-pay-button"}," Pay Securely with Stripe ",8,rs)):d("",!0),t[20]||(t[20]=s("p",{class:"security-notice"}," All payments are processed securely by Stripe. We never store your payment information. ",-1))])])])):d("",!0)]))}}),ys=B(ds,[["__scopeId","data-v-4016c403"]]);export{ys as default};

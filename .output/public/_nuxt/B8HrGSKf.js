import{j as T,G as q,o as a,c as o,a as e,m as u,v as m,t as l,F as c,s as _,q as g,B as D,l as z,y as B,n as R,r as h,J as w,_ as $,b as M}from"./Ys5eufZ_.js";import{u as H}from"./C4K7ZQHF.js";const I={class:"cert-tracker"},j={class:"tracker-header"},G={class:"header-actions"},J={class:"tracker-content"},O={key:0,class:"alert-section expiring"},Q={class:"alert-header"},K={class:"title"},W={class:"expiring-list"},X={class:"person-name"},Y={class:"cert-name"},Z={class:"expiry-date"},ee={class:"personnel-grid"},te={class:"card-header"},ne={class:"rank"},se={class:"card-info"},ie={class:"info-row"},ae={class:"value"},oe={class:"info-row"},le={class:"value"},re={key:0,class:"specializations"},de={class:"spec-tags"},ue={class:"certifications-section"},ce={key:0,class:"certs-list"},_e={class:"cert-name"},pe={key:0,class:"cert-date"},me={key:1,class:"empty-list"},ve=["onClick"],fe={class:"training-section"},ge={key:0,class:"training-list"},he={class:"training-name"},be={class:"training-date"},xe={class:"training-hours"},ye={key:1,class:"empty-list"},ke=["onClick"],Ce={class:"card-actions"},De=["onClick"],we=["onClick"],Te={key:0,class:"modal"},$e={class:"modal-content"},Ee={class:"modal-header"},Se={class:"form-group"},Ne=["value"],Ve={class:"form-group"},Fe={class:"form-group"},Ae={class:"form-group"},Le={class:"form-group"},Pe={class:"form-actions"},Ue=T({__name:"FireCertificationTracker",setup(E){const{personnel:p,loadPersonnel:y,recordTraining:b}=H(),v=h(""),d=h(!1),k=h([]),r=h({personnel_id:"",training_name:"",training_date:"",hours_completed:null,trainer:""}),S=w(()=>{if(!v.value)return p.value||[];const s=v.value.toLowerCase();return(p.value||[]).filter(t=>t.first_name.toLowerCase().includes(s)||t.last_name.toLowerCase().includes(s)||t.badge_number?.toLowerCase().includes(s))}),x=w(()=>{const s=new Date;s.setDate(s.getDate()+30);const t=[](p.value||[]).forEach(n=>{n.fire_certifications?.forEach(i=>{i.is_current&&i.expiration_date&&new Date(i.expiration_date)<=s&&t.push({id:i.id,personnel_name:`${n.first_name} ${n.last_name}`,certification_name:i.certification_name,expiration_date:i.expiration_date})})});return t});function f(s){return s?new Date(s).toLocaleDateString():"N/A"}function N(s){if(!s)return!1;const t=new Date;t.setDate(t.getDate()+30);const n=new Date(s);return n<=t&&n>new Date}function V(s){return s?new Date(s)<new Date:!1}function C(s){return k.value.filter(t=>t.personnel_id===s)}function F(s){console.log("Add certification for",s)}function A(s){r.value.personnel_id=s,d.value=!0}function L(s){console.log("Edit personnel",s)}function P(s){console.log("Download certificates for",s)}async function U(){const s=await b(r.value.personnel_id,{training_name:r.value.training_name,training_date:r.value.training_date,hours_completed:r.value.hours_completed,trainer:r.value.trainer,completion_status:"completed"});s&&(k.value.push(s),r.value={personnel_id:"",training_name:"",training_date:"",hours_completed:null,trainer:""},d.value=!1)}return q(()=>{y()}),(s,t)=>(a(),o("div",I,[e("header",j,[t[9]||(t[9]=e("h2",null,"Personnel Certifications & Training",-1)),e("div",G,[u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>v.value=n),type:"text",placeholder:"Search personnel...",class:"search-input"},null,512),[[m,v.value]]),e("button",{class:"btn-add",onClick:t[1]||(t[1]=n=>d.value=!0)},"+ Add Training")])]),e("div",J,[x.value.length>0?(a(),o("div",O,[e("div",Q,[t[10]||(t[10]=e("span",{class:"icon"},"⚠",-1)),e("span",K,l(x.value.length)+" Certifications Expiring Soon",1)]),e("div",W,[(a(!0),o(c,null,_(x.value,n=>(a(),o("div",{key:n.id,class:"expiring-item"},[e("span",X,l(n.personnel_name),1),e("span",Y,l(n.certification_name),1),e("span",Z,"Expires: "+l(f(n.expiration_date)),1)]))),128))])])):g("",!0),e("div",ee,[(a(!0),o(c,null,_(S.value,n=>(a(),o("div",{key:n.id,class:"personnel-card"},[e("div",te,[e("h3",null,l(n.first_name)+" "+l(n.last_name),1),e("span",ne,l(n.rank),1)]),e("div",se,[e("div",ie,[t[11]||(t[11]=e("span",{class:"label"},"Badge:",-1)),e("span",ae,l(n.badge_number),1)]),e("div",oe,[t[12]||(t[12]=e("span",{class:"label"},"Hired:",-1)),e("span",le,l(f(n.hire_date)),1)]),n.specializations?.length?(a(),o("div",re,[t[13]||(t[13]=e("span",{class:"label"},"Specializations:",-1)),e("div",de,[(a(!0),o(c,null,_(n.specializations,i=>(a(),o("span",{key:i,class:"spec-tag"},l(i),1))),128))])])):g("",!0)]),e("div",ue,[t[14]||(t[14]=e("h4",null,"Certifications",-1)),n.fire_certifications?.length>0?(a(),o("div",ce,[(a(!0),o(c,null,_(n.fire_certifications,i=>(a(),o("div",{key:i.id,class:D(["cert-item",{expiring:N(i.expiration_date),expired:V(i.expiration_date)}])},[e("span",_e,l(i.certification_name),1),e("span",{class:D(["cert-status",{current:i.is_current,expired:!i.is_current}])},l(i.is_current?"Current":"Expired"),3),i.expiration_date?(a(),o("span",pe,l(f(i.expiration_date)),1)):g("",!0)],2))),128))])):(a(),o("div",me," No certifications recorded ")),e("button",{class:"btn-mini",onClick:i=>F(n.id)},"+ Add Cert",8,ve)]),e("div",fe,[t[15]||(t[15]=e("h4",null,"Recent Training",-1)),C(n.id).length>0?(a(),o("div",ge,[(a(!0),o(c,null,_(C(n.id).slice(0,3),i=>(a(),o("div",{key:i.id,class:"training-item"},[e("span",he,l(i.training_name),1),e("span",be,l(f(i.training_date)),1),e("span",xe,l(i.hours_completed)+"h",1)]))),128))])):(a(),o("div",ye," No training recorded ")),e("button",{class:"btn-mini",onClick:i=>A(n.id)},"+ Add Training",8,ke)]),e("div",Ce,[e("button",{class:"btn-action",onClick:i=>L(n.id)},"Edit Profile",8,De),e("button",{class:"btn-action",onClick:i=>P(n.id)},"Download Certs",8,we)])]))),128))])]),d.value?(a(),o("div",Te,[e("div",$e,[e("div",Ee,[t[16]||(t[16]=e("h3",null,"Add Training Record",-1)),e("button",{class:"btn-close",onClick:t[2]||(t[2]=n=>d.value=!1)},"×")]),e("form",{onSubmit:z(U,["prevent"]),class:"modal-form"},[e("div",Se,[t[18]||(t[18]=e("label",null,"Personnel",-1)),u(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>r.value.personnel_id=n),required:""},[t[17]||(t[17]=e("option",{value:""},"Select personnel...",-1)),(a(!0),o(c,null,_(R(p),n=>(a(),o("option",{key:n.id,value:n.id},l(n.first_name)+" "+l(n.last_name),9,Ne))),128))],512),[[B,r.value.personnel_id]])]),e("div",Ve,[t[19]||(t[19]=e("label",null,"Training Name",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>r.value.training_name=n),type:"text",required:""},null,512),[[m,r.value.training_name]])]),e("div",Fe,[t[20]||(t[20]=e("label",null,"Training Date",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>r.value.training_date=n),type:"date",required:""},null,512),[[m,r.value.training_date]])]),e("div",Ae,[t[21]||(t[21]=e("label",null,"Hours Completed",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>r.value.hours_completed=n),type:"number",step:"0.5"},null,512),[[m,r.value.hours_completed]])]),e("div",Le,[t[22]||(t[22]=e("label",null,"Trainer",-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>r.value.trainer=n),type:"text"},null,512),[[m,r.value.trainer]])]),e("div",Pe,[t[23]||(t[23]=e("button",{type:"submit",class:"btn-primary"},"Save Training",-1)),e("button",{type:"button",class:"btn-secondary",onClick:t[8]||(t[8]=n=>d.value=!1)},"Cancel")])],32)])])):g("",!0)]))}}),qe=$(Ue,[["__scopeId","data-v-b1c98ad0"]]),ze={class:"personnel-page"},Be=T({__name:"personnel",setup(E){return(p,y)=>{const b=qe;return a(),o("div",ze,[M(b)])}}}),Ie=$(Be,[["__scopeId","data-v-af9ccd96"]]);export{Ie as default};

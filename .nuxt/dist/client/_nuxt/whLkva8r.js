import{D as p,ah as f,p as d}from"./Ys5eufZ_.js";const m="$s";function c(...e){const a=typeof e[e.length-1]=="string"?e.pop():void 0;typeof e[0]!="string"&&e.unshift(a);const[t,o]=e;if(!t||typeof t!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+t);if(o!==void 0&&typeof o!="function")throw new Error("[nuxt] [useState] init must be a function: "+o);const u=m+t,i=p(),s=f(i.payload.state,u);if(s.value===void 0&&o){const n=o();if(d(n))return i.payload.state[u]=n,n;s.value=n}return s}const v=()=>{const{$supabase:e}=p(),a=c("user",()=>null),t=c("employee",()=>null);return{user:a,employee:t,checkSession:async()=>{const{data:{session:s}}=await e.auth.getSession();if(s?.user){a.value=s.user;const{data:n}=await e.from("employees").select("*").eq("user_id",s.user.id).maybeSingle();t.value=n}},signIn:async(s,n)=>{const{data:r,error:l}=await e.auth.signInWithPassword({email:s,password:n});if(l)throw l;a.value=r.user;const{data:y}=await e.from("employees").select("*").eq("user_id",r.user.id).maybeSingle();return t.value=y,r},signOut:async()=>{await e.auth.signOut(),a.value=null,t.value=null}}};export{v as u};

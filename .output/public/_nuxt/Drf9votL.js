import{u as K}from"./aCoNAzL5.js";import{j as q,G as A,o as _,c as m,a as t,n as e,g as X,t as i,q as k,r as T,_ as P,B as R,d as F,F as I,s as B,J as x,l as Z,b as N}from"./Ys5eufZ_.js";import{u as tt}from"./Bo8boqc2.js";const et={class:"platform-revenue"},st={key:0,class:"loading"},at={key:1,class:"revenue-content"},nt={class:"revenue-metrics"},it={class:"metric-card primary"},ot={class:"metric-value"},rt={class:"metric-breakdown"},lt={class:"breakdown-item"},ct={class:"breakdown-value"},ut={class:"breakdown-item"},dt={class:"breakdown-value"},_t={class:"metric-card"},mt={class:"metric-value"},pt={class:"metric-detail"},vt={class:"metric-card"},gt={class:"metric-value"},yt={key:0,class:"metric-detail warning"},bt={class:"usage-metrics"},ht={class:"usage-grid"},ft={class:"usage-stat"},wt={class:"stat-value"},$t={class:"usage-stat"},kt={class:"stat-value"},St={class:"usage-stat"},Dt={class:"stat-value"},Tt={class:"invoice-summary"},Ct={class:"invoice-stats"},xt={class:"invoice-stat"},Rt={class:"stat-count"},qt={class:"invoice-stat paid"},At={class:"stat-count"},Pt={key:0,class:"invoice-stat overdue"},Nt={class:"stat-count"},Ft=q({__name:"PlatformRevenueBreakdown",setup(u){const{getPlatformRevenueAnalytics:$}=K(),a=T(null),b=T(!0),p=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(l/100);return A(async()=>{a.value=await $(),b.value=!1}),(l,n)=>(_(),m("div",et,[n[15]||(n[15]=t("div",{class:"panel-header"},[t("h3",null,"Platform Revenue Model"),t("p",{class:"subtitle"},"Fixed pricing: $500/month + $45/billable call")],-1)),e(b)?(_(),m("div",st,"Loading revenue data...")):e(a)?(_(),m("div",at,[n[13]||(n[13]=X('<div class="pricing-model-info" data-v-74e31ee3><div class="pricing-box" data-v-74e31ee3><span class="pricing-label" data-v-74e31ee3>Monthly Platform Fee</span><span class="pricing-value" data-v-74e31ee3>$500</span><span class="pricing-desc" data-v-74e31ee3>per agency</span></div><div class="pricing-box" data-v-74e31ee3><span class="pricing-label" data-v-74e31ee3>Per-Billable-Call Fee</span><span class="pricing-value" data-v-74e31ee3>$45</span><span class="pricing-desc" data-v-74e31ee3>per encounter</span></div></div>',1)),t("div",nt,[t("div",it,[n[2]||(n[2]=t("span",{class:"metric-label"},"Total Platform Revenue",-1)),t("span",ot,i(p(e(a).totalRevenue)),1),t("div",rt,[t("div",lt,[n[0]||(n[0]=t("span",{class:"breakdown-label"},"Recurring (Base Fees)",-1)),t("span",ct,i(p(e(a).recurringRevenue)),1)]),t("div",ut,[n[1]||(n[1]=t("span",{class:"breakdown-label"},"Usage (Call Fees)",-1)),t("span",dt,i(p(e(a).usageRevenue)),1)])])]),t("div",_t,[n[3]||(n[3]=t("span",{class:"metric-label"},"Monthly Recurring Revenue (MRR)",-1)),t("span",mt,i(p(e(a).monthlyRecurringRevenue)),1),t("span",pt,i(e(a).activeSubscriptions)+" active "+i(e(a).activeSubscriptions===1?"agency":"agencies"),1)]),t("div",vt,[n[4]||(n[4]=t("span",{class:"metric-label"},"Outstanding Amount",-1)),t("span",gt,i(p(e(a).outstandingAmount)),1),e(a).overdueInvoices>0?(_(),m("span",yt,i(e(a).overdueInvoices)+" overdue "+i(e(a).overdueInvoices===1?"invoice":"invoices"),1)):k("",!0)])]),t("div",bt,[n[8]||(n[8]=t("h4",null,"Usage Metrics",-1)),t("div",ht,[t("div",ft,[t("span",wt,i(e(a).totalBillableCalls.toLocaleString()),1),n[5]||(n[5]=t("span",{class:"stat-label"},"Total Billable Calls",-1))]),t("div",$t,[t("span",kt,i(e(a).paidCalls.toLocaleString()),1),n[6]||(n[6]=t("span",{class:"stat-label"},"Paid Calls",-1))]),t("div",St,[t("span",Dt,i(e(a).averageCallsPerAgency.toFixed(0)),1),n[7]||(n[7]=t("span",{class:"stat-label"},"Avg Calls per Agency",-1))])])]),t("div",Tt,[n[12]||(n[12]=t("h4",null,"Invoice Status",-1)),t("div",Ct,[t("div",xt,[t("span",Rt,i(e(a).totalInvoices),1),n[9]||(n[9]=t("span",{class:"stat-label"},"Total Invoices",-1))]),t("div",qt,[t("span",At,i(e(a).paidInvoices),1),n[10]||(n[10]=t("span",{class:"stat-label"},"Paid",-1))]),e(a).overdueInvoices>0?(_(),m("div",Pt,[t("span",Nt,i(e(a).overdueInvoices),1),n[11]||(n[11]=t("span",{class:"stat-label"},"Overdue",-1))])):k("",!0)])]),n[14]||(n[14]=t("div",{class:"pricing-notes"},[t("h4",null,"Pricing Policy"),t("ul",null,[t("li",null,"Base fee charged regardless of call volume"),t("li",null,"Per-call fee applies to all billable encounters"),t("li",null,"No percentage-based pricing or revenue sharing"),t("li",null,"Pricing not adjusted for automation level"),t("li",null,"Stripe fees passed through transparently (not marked up)")])],-1))])):k("",!0)]))}}),It=P(Ft,[["__scopeId","data-v-74e31ee3"]]),L=()=>{const u=useSupabaseClient();return{calculateBusinessHealth:async()=>{const b=new Date,p=new Date(b.getTime()-720*60*60*1e3);new Date(b.getTime()-2160*60*60*1e3);const l=new Date(b.getFullYear(),b.getMonth(),1),n=new Date(b.getFullYear(),0,1),{data:r}=await u.from("business_accounts").select("current_balance, sync_status, last_synced_at").eq("is_active",!0),s=r?.reduce((d,f)=>d+Number(f.current_balance),0)||0,{data:o}=await u.from("business_transactions").select("amount, transaction_date, transaction_type").gte("transaction_date",p.toISOString().split("T")[0]).order("transaction_date",{ascending:!1}),c=o?.filter(d=>Number(d.amount)>0).reduce((d,f)=>d+Number(f.amount),0)||0,g=o?.filter(d=>Number(d.amount)<0).reduce((d,f)=>d+Math.abs(Number(f.amount)),0)||0,h=g-c,v=h>0?Math.floor(s/h):1/0,{data:y}=await u.from("business_transactions").select("amount, transaction_type").gte("transaction_date",l.toISOString().split("T")[0]),D=y?.filter(d=>d.transaction_type==="revenue").reduce((d,f)=>d+Number(f.amount),0)||0,w=y?.filter(d=>["expense","payroll","tax"].includes(d.transaction_type)).reduce((d,f)=>d+Math.abs(Number(f.amount)),0)||0,S=D-w,{data:C}=await u.from("business_transactions").select("amount, transaction_type").gte("transaction_date",n.toISOString().split("T")[0]),E=C?.filter(d=>d.transaction_type==="revenue").reduce((d,f)=>d+Number(f.amount),0)||0,U=C?.filter(d=>["expense","payroll","tax"].includes(d.transaction_type)).reduce((d,f)=>d+Math.abs(Number(f.amount)),0)||0,H=E-U,{data:O}=await u.from("accounts_receivable").select("amount_outstanding, aging_bucket").eq("status","outstanding"),Y=O?.reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,V={current:O?.filter(d=>d.aging_bucket==="current").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,30:O?.filter(d=>d.aging_bucket==="30").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,60:O?.filter(d=>d.aging_bucket==="60").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,90:O?.filter(d=>d.aging_bucket==="90").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,"120_plus":O?.filter(d=>d.aging_bucket==="120_plus").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0},{data:M}=await u.from("accounts_payable").select("amount_outstanding, priority, due_date").eq("status","pending"),Q=M?.reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,W={payroll:M?.filter(d=>d.priority==="payroll").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,taxes:M?.filter(d=>d.priority==="taxes").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,critical:M?.filter(d=>d.priority==="critical").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0,normal:M?.filter(d=>d.priority==="normal").reduce((d,f)=>d+Number(f.amount_outstanding),0)||0},{data:G}=await u.from("service_lines").select("id, name").eq("is_active",!0),j=await Promise.all((G||[]).map(async d=>{const{data:f}=await u.from("business_transactions").select("amount").eq("service_line_id",d.id).eq("transaction_type","revenue").gte("transaction_date",l.toISOString().split("T")[0]);return{name:d.name,revenue:f?.reduce((z,J)=>z+Number(J.amount),0)||0}}));return{cash:{total:s,trend:c-g},burn:{monthly:h,last30DaysInflow:c,last30DaysOutflow:g},runway:v,netProfit:{mtd:S,ytd:H},ar:{total:Y,aging:V},ap:{total:Q,byPriority:W},revenueByServiceLine:j,bankFeedStatus:r?.[0]?.sync_status||"unknown",lastBankSync:r?.[0]?.last_synced_at||null}},getAccountingIntegrity:async()=>{const{data:b}=await u.from("business_accounts").select("id, account_name, sync_status, last_synced_at").eq("is_active",!0),{data:p}=await u.from("bank_reconciliations").select("reconciled_at, status").order("reconciled_at",{ascending:!1}).limit(1).maybeSingle(),{data:l}=await u.from("data_freshness_tracking").select("data_source, last_updated, is_stale"),{data:n}=await u.from("business_transactions").select("id",{count:"exact",head:!0}).eq("reconciled",!1);return{bankFeeds:b?.map(r=>({name:r.account_name,status:r.sync_status,lastSync:r.last_synced_at}))||[],lastReconciliation:p?{date:p.reconciled_at,status:p.status}:null,dataFreshness:l||[],unreconciledCount:n||0}}}},Bt={class:"business-health-summary"},Ot={class:"header"},Mt={class:"subtitle"},Et={key:0,class:"loading"},Lt={key:1,class:"metrics-grid"},Ut={class:"metric-value"},Ht={class:"metric-card"},Yt={class:"metric-value"},Vt={class:"metric-detail"},Qt={class:"metric-value"},Wt={class:"metric-card"},Gt={class:"metric-detail"},jt={class:"metric-card"},zt={class:"metric-value"},Jt={class:"metric-detail aging-breakdown"},Kt={class:"metric-card"},Xt={class:"metric-value"},Zt={class:"metric-detail"},te={key:0,class:"priority-high"},ee={key:1,class:"priority-high"},se={key:0,class:"metric-card full-width"},ae={class:"service-lines"},ne={class:"line-name"},ie={class:"line-revenue"},oe=q({__name:"BusinessHealthSummary",setup(u){const{calculateBusinessHealth:$}=L(),a=T(null),b=T(!0),p=x(()=>{if(!a.value)return"";const o=a.value.cash.total,c=a.value.burn.monthly;return o<c*2?"status-critical":o<c*6?"status-warning":"status-healthy"}),l=x(()=>{if(!a.value)return"";const o=a.value.runway;return o===1/0?"status-healthy":o<3?"status-critical":o<6?"status-warning":"status-healthy"}),n=x(()=>a.value?p.value==="status-critical"||l.value==="status-critical"?"Immediate attention needed: low cash reserves":p.value==="status-warning"||l.value==="status-warning"?"Monitor closely: cash reserves below recommended levels":"Company is operating within safe parameters":"Loading..."),r=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(o/100),s=o=>({transport:"Transport",ems:"EMS",fire_contracts:"Fire Contracts",other:"Other"})[o]||o;return A(async()=>{a.value=await $(),b.value=!1}),(o,c)=>(_(),m("div",Bt,[t("div",Ot,[c[0]||(c[0]=t("h2",null,"Business Health",-1)),t("p",Mt,i(e(n)),1)]),e(b)?(_(),m("div",Et,"Loading financial data...")):e(a)?(_(),m("div",Lt,[t("div",{class:R(["metric-card",e(p)])},[c[1]||(c[1]=t("div",{class:"metric-label"},"Cash on Hand",-1)),t("div",Ut,i(r(e(a).cash.total)),1),t("div",{class:R(["metric-trend",e(a).cash.trend>=0?"positive":"negative"])},i(e(a).cash.trend>=0?"↑":"↓")+" "+i(r(Math.abs(e(a).cash.trend)))+" (30d) ",3)],2),t("div",Ht,[c[2]||(c[2]=t("div",{class:"metric-label"},[F(" Monthly Burn "),t("span",{class:"tooltip"},[F("ⓘ "),t("span",{class:"tooltip-text"},"Cash out minus cash in over the last 30 days. Different from accounting net income.")])],-1)),t("div",Yt,i(r(e(a).burn.monthly)),1),t("div",Vt," In: "+i(r(e(a).burn.last30DaysInflow))+" | Out: "+i(r(e(a).burn.last30DaysOutflow)),1)]),t("div",{class:R(["metric-card",e(l)])},[c[3]||(c[3]=t("div",{class:"metric-label"},[F(" Runway "),t("span",{class:"tooltip"},[F("ⓘ "),t("span",{class:"tooltip-text"},"Months until cash runs out at current burn rate. Cash balance ÷ monthly burn.")])],-1)),t("div",Qt,i(e(a).runway===1/0?"∞":e(a).runway)+" "+i(e(a).runway===1/0?"":e(a).runway===1?"month":"months"),1)],2),t("div",Wt,[c[4]||(c[4]=t("div",{class:"metric-label"},[F(" Net Profit/Loss "),t("span",{class:"tooltip"},[F("ⓘ "),t("span",{class:"tooltip-text"},"Accounting view (revenue minus expenses). Different from burn rate.")])],-1)),t("div",{class:R(["metric-value",e(a).netProfit.mtd>=0?"positive":"negative"])},i(r(e(a).netProfit.mtd)),3),t("div",Gt,"MTD | YTD: "+i(r(e(a).netProfit.ytd)),1)]),t("div",jt,[c[5]||(c[5]=t("div",{class:"metric-label"},"Accounts Receivable",-1)),t("div",zt,i(r(e(a).ar.total)),1),t("div",Jt,[t("span",null,"Current: "+i(r(e(a).ar.aging.current)),1),t("span",null,"30+: "+i(r(e(a).ar.aging[30])),1),t("span",null,"60+: "+i(r(e(a).ar.aging[60])),1),t("span",null,"90+: "+i(r(e(a).ar.aging[90])),1)])]),t("div",Kt,[c[6]||(c[6]=t("div",{class:"metric-label"},"Accounts Payable",-1)),t("div",Xt,i(r(e(a).ap.total)),1),t("div",Zt,[e(a).ap.byPriority.payroll>0?(_(),m("span",te," Payroll: "+i(r(e(a).ap.byPriority.payroll)),1)):k("",!0),e(a).ap.byPriority.taxes>0?(_(),m("span",ee," Taxes: "+i(r(e(a).ap.byPriority.taxes)),1)):k("",!0)])]),e(a).revenueByServiceLine.length>0?(_(),m("div",se,[c[7]||(c[7]=t("div",{class:"metric-label"},"Revenue by Service Line (MTD)",-1)),t("div",ae,[(_(!0),m(I,null,B(e(a).revenueByServiceLine,g=>(_(),m("div",{key:g.name,class:"service-line"},[t("span",ne,i(s(g.name)),1),t("span",ie,i(r(g.revenue)),1)]))),128))])])):k("",!0)])):k("",!0)]))}}),re=P(oe,[["__scopeId","data-v-9bfd8a00"]]),le={class:"accounting-integrity"},ce={key:0,class:"loading"},ue={key:1,class:"integrity-grid"},de={class:"value"},_e={key:0,class:"detail"},me={class:"value"},pe={key:0,class:"detail"},ve={class:"integrity-item"},ge={class:"value"},ye={class:"value"},be={key:0,class:"detail warning"},he=q({__name:"AccountingIntegrityStrip",setup(u){const{getAccountingIntegrity:$}=L(),a=T(null),b=T(!0),p=x(()=>a.value?.bankFeeds[0]?a.value.bankFeeds[0].status==="connected"?"Connected":"Degraded":"Unknown"),l=x(()=>a.value?.bankFeeds[0]?a.value.bankFeeds[0].status==="connected"?"status-good":"status-warning":"status-unknown"),n=x(()=>{if(!a.value?.lastReconciliation)return"Never reconciled";const v=Math.floor((Date.now()-new Date(a.value.lastReconciliation.date).getTime())/(1e3*60*60*24));return v>30?"Stale":v>14?"Needs attention":"Current"}),r=x(()=>{const v=n.value;return v==="Never reconciled"||v==="Stale"?"status-critical":v==="Needs attention"?"status-warning":"status-good"}),s=x(()=>a.value?.dataFreshness?a.value.dataFreshness.filter(v=>v.is_stale).map(v=>v.data_source.replace(/_/g," ")):[]),o=x(()=>{const v=s.value.length;return v===0?"All current":`${v} stale`}),c=x(()=>s.value.length>0?"status-warning":"status-good"),g=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),h=v=>{const y=new Date(v),w=Date.now()-y.getTime(),S=Math.floor(w/(1e3*60*60));return S<24?`${S}h ago`:`${Math.floor(S/24)}d ago`};return A(async()=>{a.value=await $(),b.value=!1}),(v,y)=>(_(),m("div",le,[y[4]||(y[4]=t("h3",null,"Accounting Integrity",-1)),y[5]||(y[5]=t("p",{class:"question"},"Can I trust the numbers on this screen?",-1)),e(b)?(_(),m("div",ce,"Checking data integrity...")):e(a)?(_(),m("div",ue,[t("div",{class:R(["integrity-item",e(l)])},[y[0]||(y[0]=t("span",{class:"label"},"Bank Feed",-1)),t("span",de,i(e(p)),1),e(a).bankFeeds[0]?.lastSync?(_(),m("span",_e," Last sync: "+i(h(e(a).bankFeeds[0].lastSync)),1)):k("",!0)],2),t("div",{class:R(["integrity-item",e(r)])},[y[1]||(y[1]=t("span",{class:"label"},"Reconciliation",-1)),t("span",me,i(e(n)),1),e(a).lastReconciliation?(_(),m("span",pe," Last: "+i(g(e(a).lastReconciliation.date)),1)):k("",!0)],2),t("div",ve,[y[2]||(y[2]=t("span",{class:"label"},"Unreconciled Transactions",-1)),t("span",ge,i(e(a).unreconciledCount),1)]),t("div",{class:R(["integrity-item",e(c)])},[y[3]||(y[3]=t("span",{class:"label"},"Data Freshness",-1)),t("span",ye,i(e(o)),1),e(s).length>0?(_(),m("span",be," Stale: "+i(e(s).join(", ")),1)):k("",!0)],2)])):k("",!0)]))}}),fe=P(he,[["__scopeId","data-v-2cc3db56"]]),we=()=>{const u=useSupabaseClient();return{getTaxObligations:async()=>{const p=new Date,l=new Date(p.getTime()+720*60*60*1e3),{data:n}=await u.from("business_tax_reserves").select("*").in("status",["accruing","due_soon"]).lte("due_date",l.toISOString().split("T")[0]).order("due_date",{ascending:!0}),{data:r}=await u.from("business_tax_reserves").select("*").eq("status","overdue").order("due_date",{ascending:!0}),{data:s}=await u.from("business_tax_reserves").select("amount_expected, amount_reserved, status").in("status",["accruing","due_soon","overdue"]),o=s?.reduce((h,v)=>h+Number(v.amount_expected),0)||0,c=s?.reduce((h,v)=>h+Number(v.amount_reserved),0)||0,g=Math.max(0,o-c);return{upcoming:n||[],overdue:r||[],summary:{totalExpected:o,totalReserved:c,shortfall:g,isFullyFunded:g===0}}},updateTaxReserve:async(p,l)=>{const{error:n}=await u.from("business_tax_reserves").update({amount_reserved:l,updated_at:new Date().toISOString()}).eq("id",p);if(n)throw n},markTaxPaid:async p=>{const{error:l}=await u.from("business_tax_reserves").update({status:"paid",paid_date:new Date().toISOString().split("T")[0]}).eq("id",p);if(l)throw l}}},$e={class:"tax-safety"},ke={key:0,class:"loading"},Se={key:1,class:"tax-content"},De={class:"summary-row"},Te={class:"summary-item"},Ce={class:"value"},xe={class:"summary-item"},Re={class:"value"},qe={class:"value"},Ae={key:0,class:"alert-section critical"},Pe={key:1,class:"obligations-list"},Ne={class:"tax-info"},Fe={class:"tax-type"},Ie={class:"tax-period"},Be={class:"tax-amounts"},Oe={class:"due-date"},Me=q({__name:"TaxSafetyBlock",setup(u){const{getTaxObligations:$}=we(),a=T(null),b=T(!0),p=x(()=>a.value?a.value.summary.shortfall>0?"status-warning":"status-good":""),l=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s/100),n=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),r=s=>({payroll_federal:"Federal Payroll Tax",payroll_state:"State Payroll Tax",payroll_local:"Local Payroll Tax",sales:"Sales Tax",estimated_income:"Estimated Income Tax",property:"Property Tax",other:"Other Tax"})[s]||s;return A(async()=>{a.value=await $(),b.value=!1}),(s,o)=>(_(),m("div",$e,[o[4]||(o[4]=t("h3",null,"Tax Safety",-1)),o[5]||(o[5]=t("p",{class:"subtitle"},"Business tax obligations and reserves",-1)),e(b)?(_(),m("div",ke,"Loading tax data...")):e(a)?(_(),m("div",Se,[t("div",De,[t("div",Te,[o[0]||(o[0]=t("span",{class:"label"},"Total Expected",-1)),t("span",Ce,i(l(e(a).summary.totalExpected)),1)]),t("div",xe,[o[1]||(o[1]=t("span",{class:"label"},"Total Reserved",-1)),t("span",Re,i(l(e(a).summary.totalReserved)),1)]),t("div",{class:R(["summary-item",e(p)])},[o[2]||(o[2]=t("span",{class:"label"},"Shortfall",-1)),t("span",qe,i(l(e(a).summary.shortfall)),1)],2)]),e(a).overdue.length>0?(_(),m("div",Ae,[t("strong",null,"⚠ Overdue Obligations ("+i(e(a).overdue.length)+")",1),(_(!0),m(I,null,B(e(a).overdue,c=>(_(),m("div",{key:c.id,class:"tax-item"},[t("span",null,i(r(c.tax_type)),1),t("span",null,"Due: "+i(n(c.due_date)),1),t("span",null,i(l(c.amount_expected)),1)]))),128))])):k("",!0),e(a).upcoming.length>0?(_(),m("div",Pe,[o[3]||(o[3]=t("h4",null,"Upcoming (Next 30 Days)",-1)),(_(!0),m(I,null,B(e(a).upcoming,c=>(_(),m("div",{key:c.id,class:"tax-item"},[t("div",Ne,[t("span",Fe,i(r(c.tax_type)),1),t("span",Ie,i(n(c.period_start))+" - "+i(n(c.period_end)),1)]),t("div",Be,[t("span",null,"Expected: "+i(l(c.amount_expected)),1),t("span",null,"Reserved: "+i(l(c.amount_reserved)),1),t("span",Oe,"Due: "+i(n(c.due_date)),1)])]))),128))])):k("",!0)])):k("",!0)]))}}),Ee=P(Me,[["__scopeId","data-v-cb0aae78"]]),Le=()=>{const u=useSupabaseClient(),$=useSupabaseUser();return{getCompensationSummary:async()=>{const l=new Date,n=new Date(l.getFullYear(),0,1),{data:r}=await u.from("founder_compensation_events").select("event_type, amount, event_date").eq("founder_id",$.value?.id).gte("event_date",n.toISOString().split("T")[0]).order("event_date",{ascending:!1}),s=r?.filter(c=>c.event_type==="salary").reduce((c,g)=>c+Number(g.amount),0)||0,o=r?.filter(c=>c.event_type==="distribution").reduce((c,g)=>c+Number(g.amount),0)||0;return{salaryYTD:s,distributionsYTD:o,totalYTD:s+o,events:r||[]}},calculateSafeDistribution:async()=>{const{data:l}=await u.from("founder_compensation_policy").select("*").limit(1).maybeSingle();if(!l)return{safeAmount:0,breakdown:{totalCash:0,minimumBuffer:0,payrollReserve:0,taxReserve:0,apReserve:0,available:0}};const{data:n}=await u.from("business_accounts").select("current_balance").eq("is_active",!0),r=n?.reduce((w,S)=>w+Number(S.current_balance),0)||0,{data:s}=await u.from("accounts_payable").select("amount_outstanding, priority").eq("status","pending"),o=s?.filter(w=>w.priority==="payroll").reduce((w,S)=>w+Number(S.amount_outstanding),0)||0,c=s?.filter(w=>w.priority==="taxes").reduce((w,S)=>w+Number(S.amount_outstanding),0)||0,g=s?.filter(w=>["critical","normal"].includes(w.priority)).reduce((w,S)=>w+Number(S.amount_outstanding),0)||0,h=Number(l.minimum_cash_buffer),v=Math.max(0,r-h-o-c-g),y=Math.floor(v*(Number(l.safe_distribution_percentage)/100)),D={totalCash:r,minimumBuffer:h,payrollReserve:o,taxReserve:c,apReserve:g,available:v};return await u.from("founder_withdrawal_calculations").insert({total_cash_available:r,minimum_buffer_required:h,payroll_reserve_required:o,tax_reserve_required:c,ap_reserve_required:g,available_for_distribution:v,safe_distribution_amount:y,calculation_notes:"Automated calculation"}),{safeAmount:y,breakdown:D}},getCompensationPolicy:async()=>{const{data:l}=await u.from("founder_compensation_policy").select("*").limit(1).maybeSingle();return l}}},Ue={class:"founder-compensation"},He={key:0,class:"loading"},Ye={key:1,class:"compensation-content"},Ve={class:"summary-grid"},Qe={class:"summary-card"},We={class:"value"},Ge={class:"summary-card"},je={class:"value"},ze={class:"summary-card highlight"},Je={class:"value large"},Ke={class:"breakdown"},Xe={class:"breakdown-content"},Ze={class:"breakdown-row"},ts={class:"breakdown-row deduction"},es={class:"breakdown-row deduction"},ss={class:"breakdown-row deduction"},as={class:"breakdown-row deduction"},ns={class:"breakdown-row total"},is=q({__name:"FounderCompensationGuardrails",setup(u){const{getCompensationSummary:$,calculateSafeDistribution:a}=Le(),b=T(null),p=T(null),l=T(!0),n=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r/100);return A(async()=>{b.value=await $(),p.value=await a(),l.value=!1}),(r,s)=>(_(),m("div",Ue,[s[12]||(s[12]=t("h3",null,"Founder Compensation Guardrails",-1)),s[13]||(s[13]=t("p",{class:"subtitle"},"Business-side record of compensation (not personal finances)",-1)),e(l)?(_(),m("div",He,"Loading compensation data...")):e(b)&&e(p)?(_(),m("div",Ye,[t("div",Ve,[t("div",Qe,[s[0]||(s[0]=t("span",{class:"label"},"Salary Paid YTD",-1)),t("span",We,i(n(e(b).salaryYTD)),1)]),t("div",Ge,[s[1]||(s[1]=t("span",{class:"label"},"Distributions YTD",-1)),t("span",je,i(n(e(b).distributionsYTD)),1)]),t("div",ze,[s[2]||(s[2]=t("span",{class:"label"},"Safe to Distribute Now",-1)),t("span",Je,i(n(e(p).safeAmount)),1),s[3]||(s[3]=t("span",{class:"help-text"},"Based on cash safety rules",-1))])]),t("details",Ke,[s[10]||(s[10]=t("summary",null,"View Calculation Breakdown",-1)),t("div",Xe,[t("div",Ze,[s[4]||(s[4]=t("span",null,"Total Cash Available",-1)),t("span",null,i(n(e(p).breakdown.totalCash)),1)]),t("div",ts,[s[5]||(s[5]=t("span",null,"Minimum Cash Buffer",-1)),t("span",null,"-"+i(n(e(p).breakdown.minimumBuffer)),1)]),t("div",es,[s[6]||(s[6]=t("span",null,"Payroll Reserve",-1)),t("span",null,"-"+i(n(e(p).breakdown.payrollReserve)),1)]),t("div",ss,[s[7]||(s[7]=t("span",null,"Tax Reserve",-1)),t("span",null,"-"+i(n(e(p).breakdown.taxReserve)),1)]),t("div",as,[s[8]||(s[8]=t("span",null,"AP Reserve",-1)),t("span",null,"-"+i(n(e(p).breakdown.apReserve)),1)]),t("div",ns,[s[9]||(s[9]=t("span",null,"Available for Distribution",-1)),t("span",null,i(n(e(p).breakdown.available)),1)])])]),s[11]||(s[11]=t("div",{class:"notice"},[t("p",null,"This system tracks only what the business pays to you. It does not track personal finances, personal spending, or what you do with distributions after they leave the business.")],-1))])):k("",!0)]))}}),os=P(is,[["__scopeId","data-v-302d3144"]]),rs=()=>{const u=useSupabaseClient();return{getWorkQueue:async()=>{const{data:l}=await u.from("billing_work_queue").select(`
        *,
        billing_claims (
          claim_number,
          patient_name,
          service_date,
          billed_amount,
          payer_name,
          claim_status
        )
      `).eq("status","pending").order("queue_priority",{ascending:!0}).order("added_to_queue_at",{ascending:!0}),n=l?.reduce((r,s)=>{const o=s.action_required;return r[o]||(r[o]=[]),r[o].push(s),r},{});return{queue:l||[],grouped:n||{},count:l?.length||0}},getClaimDetails:async l=>{const{data:n}=await u.from("billing_claims").select("*").eq("id",l).maybeSingle(),{data:r}=await u.from("eligibility_checks").select("*").eq("claim_id",l).order("checked_at",{ascending:!1}).limit(1).maybeSingle(),{data:s}=await u.from("claim_submissions").select("*").eq("claim_id",l).order("submitted_at",{ascending:!1}),{data:o}=await u.from("claim_status_inquiries").select("*").eq("claim_id",l).order("inquired_at",{ascending:!1}),{data:c}=await u.from("remittance_advices").select("*").eq("claim_id",l).order("received_at",{ascending:!1}),{data:g}=await u.from("edi_transactions").select("*").eq("claim_id",l).order("created_at",{ascending:!1});return{claim:n,eligibility:r,submissions:s||[],statusInquiries:o||[],remittances:c||[],ediTransactions:g||[]}},performAction:async(l,n,r,s)=>{const o=useSupabaseUser();if(await u.from("audit_log").insert({event_type:"billing_action",actor_id:o.value?.id,actor_role:"biller",resource_type:"billing_claim",resource_id:r,action:n,result:"success",details:{queueItemId:l,...s}}),n==="verify_eligibility"&&(await u.from("edi_transactions").insert({claim_id:r,transaction_type:"270",direction:"outbound",status:"pending",sent_at:new Date().toISOString()}),await u.from("billing_claims").update({claim_status:"eligibility_pending",next_action_required:"wait_for_eligibility",updated_at:new Date().toISOString()}).eq("id",r)),n==="submit_claim"){const{data:c}=await u.from("claim_submissions").insert({claim_id:r,submission_method:"electronic",clearinghouse_status:"pending"}).select().single();await u.from("edi_transactions").insert({claim_id:r,transaction_type:"837",direction:"outbound",status:"pending",sent_at:new Date().toISOString()}),await u.from("billing_claims").update({claim_status:"submitted",next_action_required:"wait_for_clearinghouse",updated_at:new Date().toISOString()}).eq("id",r)}n==="check_status"&&(await u.from("edi_transactions").insert({claim_id:r,transaction_type:"276",direction:"outbound",status:"pending",sent_at:new Date().toISOString()}),await u.from("billing_claims").update({next_action_required:"wait_for_status_response",updated_at:new Date().toISOString()}).eq("id",r)),await u.from("billing_work_queue").update({status:"completed",action_taken_at:new Date().toISOString()}).eq("id",l)},addToQueue:async(l,n,r,s=100)=>{const{error:o}=await u.from("billing_work_queue").insert({claim_id:l,action_required:n,blocking_reason:r,queue_priority:s,status:"pending"});if(o)throw o}}},ls={class:"billing-command-center"},cs={key:0,class:"loading"},us={key:1,class:"queue-content"},ds={class:"queue-summary"},_s={class:"summary-stat"},ms={class:"stat-value"},ps={key:0,class:"empty-state"},vs={key:1,class:"queue-groups"},gs={class:"group-title"},ys={class:"count-badge"},bs={class:"queue-items"},hs=["onClick"],fs={class:"item-info"},ws={class:"claim-number"},$s={class:"patient-name"},ks={class:"service-date"},Ss={class:"item-details"},Ds={class:"payer"},Ts={class:"amount"},Cs={class:"item-reason"},xs={class:"modal-header"},Rs={class:"modal-body"},qs={class:"triage-section"},As={class:"triage-section"},Ps={class:"detail-row"},Ns={class:"detail-row"},Fs={class:"detail-row"},Is={class:"detail-row"},Bs={class:"detail-row"},Os={class:"triage-section"},Ms={class:"modal-footer"},Es=q({__name:"BillingCommandCenter",setup(u){const{getWorkQueue:$,performAction:a}=rs(),b=T(null),p=T(!0),l=T(null),n=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(v/100),r=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),s=v=>({verify_eligibility:"Verify Eligibility",recheck_eligibility:"Recheck Eligibility",submit_claim:"Submit Claim",resubmit_claim:"Resubmit Claim",check_status:"Check Status",review_denial:"Review Denial",attach_documentation:"Attach Documentation",post_payment:"Post Payment",contact_payer:"Contact Payer",patient_follow_up:"Patient Follow-up"})[v]||v,o=v=>({verify_eligibility:"Run Eligibility Check",recheck_eligibility:"Recheck Eligibility",submit_claim:"Submit Claim",resubmit_claim:"Resubmit Claim",check_status:"Request Status",review_denial:"Review & Decide",attach_documentation:"Attach Docs",post_payment:"Post to AR",contact_payer:"Log Payer Call",patient_follow_up:"Contact Patient"})[v]||"Take Action",c=v=>{l.value=v},g=()=>{l.value=null},h=async()=>{l.value&&(await a(l.value.id,l.value.action_required,l.value.claim_id,{}),g(),b.value=await $())};return A(async()=>{b.value=await $(),p.value=!1}),(v,y)=>(_(),m("div",ls,[y[11]||(y[11]=t("div",{class:"header"},[t("h3",null,"Billing Command Center"),t("p",{class:"subtitle"},"Operational queue for solo biller")],-1)),e(p)?(_(),m("div",cs,"Loading billing queue...")):e(b)?(_(),m("div",us,[t("div",ds,[t("div",_s,[t("span",ms,i(e(b).count),1),y[1]||(y[1]=t("span",{class:"stat-label"},"Claims Need Action",-1))])]),e(b).count===0?(_(),m("div",ps,[...y[2]||(y[2]=[t("p",null,"No claims in queue. All billing tasks are current.",-1)])])):(_(),m("div",vs,[(_(!0),m(I,null,B(e(b).grouped,(D,w)=>(_(),m("div",{key:w,class:"queue-group"},[t("h4",gs,[F(i(s(w))+" ",1),t("span",ys,i(D.length),1)]),t("div",bs,[(_(!0),m(I,null,B(D,S=>(_(),m("div",{key:S.id,class:"queue-item",onClick:C=>c(S)},[t("div",fs,[t("span",ws,i(S.billing_claims?.claim_number),1),t("span",$s,i(S.billing_claims?.patient_name),1),t("span",ks,i(r(S.billing_claims?.service_date)),1)]),t("div",Ss,[t("span",Ds,i(S.billing_claims?.payer_name),1),t("span",Ts,i(n(S.billing_claims?.billed_amount)),1)]),t("div",Cs,i(S.blocking_reason),1)],8,hs))),128))])]))),128))]))])):k("",!0),e(l)?(_(),m("div",{key:2,class:"modal-overlay",onClick:g},[t("div",{class:"modal",onClick:y[0]||(y[0]=Z(()=>{},["stop"]))},[t("div",xs,[t("h3",null,"Claim Triage: "+i(e(l).billing_claims?.claim_number),1),t("button",{onClick:g,class:"close-button"},"×")]),t("div",Rs,[t("div",qs,[y[3]||(y[3]=t("h4",null,"What's Blocking Payment",-1)),t("p",null,i(e(l).blocking_reason),1)]),t("div",As,[y[9]||(y[9]=t("h4",null,"Claim Details",-1)),t("div",Ps,[y[4]||(y[4]=t("span",null,"Patient:",-1)),t("span",null,i(e(l).billing_claims?.patient_name),1)]),t("div",Ns,[y[5]||(y[5]=t("span",null,"Service Date:",-1)),t("span",null,i(r(e(l).billing_claims?.service_date)),1)]),t("div",Fs,[y[6]||(y[6]=t("span",null,"Payer:",-1)),t("span",null,i(e(l).billing_claims?.payer_name),1)]),t("div",Is,[y[7]||(y[7]=t("span",null,"Amount:",-1)),t("span",null,i(n(e(l).billing_claims?.billed_amount)),1)]),t("div",Bs,[y[8]||(y[8]=t("span",null,"Status:",-1)),t("span",null,i(e(l).billing_claims?.claim_status),1)])]),t("div",Os,[y[10]||(y[10]=t("h4",null,"Action Required",-1)),t("p",null,i(s(e(l).action_required)),1)])]),t("div",Ms,[t("button",{onClick:h,class:"action-button primary"},i(o(e(l).action_required)),1),t("button",{onClick:g,class:"action-button"},"Cancel")])])])):k("",!0)]))}}),Ls=P(Es,[["__scopeId","data-v-4295016d"]]),Us={class:"private-pay-revenue"},Hs={key:0,class:"loading"},Ys={key:1,class:"revenue-content"},Vs={class:"summary-grid"},Qs={class:"summary-card highlight"},Ws={class:"value"},Gs={class:"summary-card"},js={class:"value"},zs={class:"summary-card"},Js={class:"value"},Ks={class:"breakdown-section"},Xs={class:"breakdown-grid"},Zs={class:"breakdown-item"},ta={class:"breakdown-value"},ea={class:"breakdown-item"},sa={class:"breakdown-value"},aa={class:"status-section"},na={class:"status-grid"},ia={class:"status-item"},oa={class:"status-count"},ra={class:"status-item warning"},la={class:"status-count"},ca={class:"status-item critical"},ua={class:"status-count"},da={key:0,class:"alert-box"},_a={key:0},ma={key:1},pa=q({__name:"PrivatePayRevenue",setup(u){const{getPrivatePayAnalytics:$}=tt(),a=T(null),b=T(!0),p=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(l/100);return A(async()=>{a.value=await $(),b.value=!1}),(l,n)=>(_(),m("div",Us,[n[12]||(n[12]=t("h3",null,"Private-Pay Revenue",-1)),n[13]||(n[13]=t("p",{class:"subtitle"},"Patient billing separate from insurance",-1)),e(b)?(_(),m("div",Hs,"Loading private-pay data...")):e(a)?(_(),m("div",Ys,[t("div",Vs,[t("div",Qs,[n[0]||(n[0]=t("span",{class:"label"},"Total Revenue",-1)),t("span",Ws,i(p(e(a).totalRevenue)),1)]),t("div",Gs,[n[1]||(n[1]=t("span",{class:"label"},"Outstanding Balance",-1)),t("span",js,i(p(e(a).outstandingBalance)),1)]),t("div",zs,[n[2]||(n[2]=t("span",{class:"label"},"Payment Success Rate",-1)),t("span",Js,i(e(a).completionRate.toFixed(1))+"%",1)])]),t("div",Ks,[n[5]||(n[5]=t("h4",null,"Revenue by Service Type",-1)),t("div",Xs,[t("div",Zs,[n[3]||(n[3]=t("span",{class:"breakdown-label"},"Ambulance Transport",-1)),t("span",ta,i(p(e(a).ambulanceRevenue)),1)]),t("div",ea,[n[4]||(n[4]=t("span",{class:"breakdown-label"},"Telehealth",-1)),t("span",sa,i(p(e(a).telehealthRevenue)),1)])])]),t("div",aa,[n[9]||(n[9]=t("h4",null,"Payment Status",-1)),t("div",na,[t("div",ia,[t("span",oa,i(e(a).paidCount),1),n[6]||(n[6]=t("span",{class:"status-label"},"Paid",-1))]),t("div",ra,[t("span",la,i(e(a).failedCount),1),n[7]||(n[7]=t("span",{class:"status-label"},"Failed",-1))]),t("div",ca,[t("span",ua,i(e(a).disputedCount),1),n[8]||(n[8]=t("span",{class:"status-label"},"Disputed",-1))])])]),e(a).failedCount>0||e(a).disputedCount>0?(_(),m("div",da,[n[10]||(n[10]=t("strong",null,"Attention Required",-1)),e(a).failedCount>0?(_(),m("p",_a,i(e(a).failedCount)+" failed "+i(e(a).failedCount===1?"payment":"payments")+" need follow-up ",1)):k("",!0),e(a).disputedCount>0?(_(),m("p",ma,i(e(a).disputedCount)+" "+i(e(a).disputedCount===1?"dispute":"disputes")+" in progress ",1)):k("",!0)])):k("",!0),n[11]||(n[11]=t("div",{class:"notice"},[t("p",null,"All payment processing is handled securely by Stripe. No payment data is stored on this platform.")],-1))])):k("",!0)]))}}),va=P(pa,[["__scopeId","data-v-a8308937"]]),ga=()=>{const u=useSupabaseClient();return{createTelehealthEncounter:async s=>{const o=`TH-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,{data:c,error:g}=await u.from("telehealth_encounters").insert({encounter_number:o,patient_name:s.patientName,patient_dob:s.patientDob,session_start:s.sessionStart,provider_type:s.providerType,service_category:s.serviceCategory,disposition:s.disposition,is_billable:!0}).select().single();if(g)throw g;return c},completeTelehealthSession:async(s,o,c,g,h)=>{const v=new Date((await u.from("telehealth_encounters").select("session_start").eq("id",s).single()).data?.session_start||""),y=new Date(o),D=Math.round((y.getTime()-v.getTime())/6e4),{error:w}=await u.from("telehealth_encounters").update({session_end:o,duration_minutes:D,clinical_notes:c,resulted_in_transport:g,transport_incident_id:h||null,updated_at:new Date().toISOString()}).eq("id",s);if(w)throw w},createTelehealthBillingEvent:async s=>{const{data:o,error:c}=await u.from("telehealth_billing_events").insert({encounter_id:s.encounterId,cpt_code:s.cptCode,service_description:s.serviceDescription,charge_amount:s.chargeAmount,payer_path:s.payerPath,billing_claim_id:s.billingClaimId||null,private_invoice_id:s.privateInvoiceId||null,billing_status:"pending"}).select().single();if(c)throw c;return o},linkTelehealthToTransport:async(s,o,c,g)=>{const{error:h}=await u.from("telehealth_transport_bundles").insert({telehealth_encounter_id:s,transport_incident_id:o,billing_relationship:c,bundling_rule:g});if(h)throw h},getTelehealthEncounters:async s=>{let o=u.from("telehealth_encounters").select("*").order("session_start",{ascending:!1});s?.startDate&&(o=o.gte("session_start",s.startDate)),s?.endDate&&(o=o.lte("session_start",s.endDate)),s?.disposition&&(o=o.eq("disposition",s.disposition)),s?.isBillable!==void 0&&(o=o.eq("is_billable",s.isBillable));const{data:c,error:g}=await o;if(g)throw g;return c||[]},getTelehealthBillingEvents:async s=>{const{data:o,error:c}=await u.from("telehealth_billing_events").select("*").eq("encounter_id",s);if(c)throw c;return o||[]},getTelehealthAnalytics:async()=>{const{data:s}=await u.from("telehealth_encounters").select("*"),{data:o}=await u.from("telehealth_billing_events").select("*"),c=s?.length||0,g=s?.filter(D=>D.is_billable).length||0,h=s?.filter(D=>D.resulted_in_transport).length||0,v=o?.reduce((D,w)=>D+Number(w.charge_amount),0)||0,y=o?.filter(D=>D.billing_status==="paid").reduce((D,w)=>D+Number(w.charge_amount),0)||0;return{totalEncounters:c,billableEncounters:g,transportDispatched:h,totalRevenue:v,paidRevenue:y,transportRate:c?h/c*100:0}}}},ya={class:"telehealth-billing"},ba={key:0,class:"loading"},ha={key:1,class:"content"},fa={class:"metrics-grid"},wa={class:"metric-card"},$a={class:"metric-value"},ka={class:"metric-card"},Sa={class:"metric-value"},Da={class:"metric-card"},Ta={class:"metric-value"},Ca={class:"metric-detail"},xa={class:"metric-card highlight"},Ra={class:"metric-value"},qa={class:"metric-detail"},Aa={class:"encounters-section"},Pa={key:0,class:"empty-state"},Na={key:1,class:"encounters-list"},Fa={class:"encounter-info"},Ia={class:"encounter-number"},Ba={class:"encounter-date"},Oa={class:"encounter-details"},Ma={key:0},Ea={class:"encounter-status"},La=q({__name:"TelehealthBillingPanel",setup(u){const{getTelehealthAnalytics:$,getTelehealthEncounters:a}=ga(),b=T(null),p=T([]),l=T(!0),n=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(g/100),r=g=>new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),s=g=>({physician:"MD",nurse_practitioner:"NP",physician_assistant:"PA",nurse:"RN",paramedic:"Paramedic",emt:"EMT"})[g]||g,o=g=>({consultation:"Consultation",follow_up:"Follow-up",triage:"Triage",assessment:"Assessment",urgent_care:"Urgent Care",mental_health:"Mental Health"})[g]||g,c=g=>({resolved:"Resolved",ems_dispatched:"EMS Dispatched",referred:"Referred",follow_up_needed:"Follow-up",transferred:"Transferred",self_care:"Self-care"})[g]||g;return A(async()=>{b.value=await $(),p.value=await a({isBillable:!0}),l.value=!1}),(g,h)=>(_(),m("div",ya,[h[5]||(h[5]=t("div",{class:"panel-header"},[t("h3",null,"Telehealth Billing"),t("p",{class:"subtitle"},"Carefusion Telehealth encounters and revenue")],-1)),e(l)?(_(),m("div",ba,"Loading telehealth data...")):e(b)?(_(),m("div",ha,[t("div",fa,[t("div",wa,[h[0]||(h[0]=t("span",{class:"metric-label"},"Total Encounters",-1)),t("span",$a,i(e(b).totalEncounters),1)]),t("div",ka,[h[1]||(h[1]=t("span",{class:"metric-label"},"Billable Encounters",-1)),t("span",Sa,i(e(b).billableEncounters),1)]),t("div",Da,[h[2]||(h[2]=t("span",{class:"metric-label"},"Transport Dispatched",-1)),t("span",Ta,i(e(b).transportDispatched),1),t("span",Ca,i(e(b).transportRate.toFixed(1))+"% dispatch rate",1)]),t("div",xa,[h[3]||(h[3]=t("span",{class:"metric-label"},"Telehealth Revenue",-1)),t("span",Ra,i(n(e(b).paidRevenue)),1),t("span",qa,"of "+i(n(e(b).totalRevenue))+" billed",1)])]),t("div",Aa,[h[4]||(h[4]=t("h4",null,"Recent Encounters",-1)),e(p).length===0?(_(),m("div",Pa," No telehealth encounters yet ")):(_(),m("div",Na,[(_(!0),m(I,null,B(e(p),v=>(_(),m("div",{key:v.id,class:"encounter-item"},[t("div",Fa,[t("span",Ia,i(v.encounter_number),1),t("span",Ba,i(r(v.session_start)),1)]),t("div",Oa,[t("span",null,i(s(v.provider_type)),1),t("span",null,i(o(v.service_category)),1),v.duration_minutes?(_(),m("span",Ma,i(v.duration_minutes)+" min",1)):k("",!0)]),t("div",Ea,[t("span",{class:R(["disposition-badge",v.resulted_in_transport?"transport":"resolved"])},i(c(v.disposition)),3)])]))),128))]))])])):k("",!0)]))}}),Ua=P(La,[["__scopeId","data-v-17617311"]]),Ha=()=>{const u=useSupabaseClient();return{getHealthSignals:async()=>{const{data:r}=await u.from("system_health_signals").select("*").order("system_name"),{data:s}=await u.from("tool_integration_status").select("*").order("tool_name");return{signals:r||[],tools:s||[]}},getActiveAlerts:async()=>{const{data:r}=await u.from("dashboard_alerts").select("*").is("resolved_at",null).order("severity",{ascending:!1}).order("triggered_at",{ascending:!1});return r||[]},acknowledgeAlert:async r=>{const s=useSupabaseUser(),{error:o}=await u.from("dashboard_alerts").update({acknowledged_at:new Date().toISOString(),acknowledged_by:s.value?.id}).eq("id",r);if(o)throw o},resolveAlert:async r=>{const{error:s}=await u.from("dashboard_alerts").update({resolved_at:new Date().toISOString()}).eq("id",r);if(s)throw s},createAlert:async r=>{const{error:s}=await u.from("dashboard_alerts").insert({alert_type:r.alertType,severity:r.severity,title:r.title,message:r.message,action_required:r.actionRequired,context:r.context||{}});if(s)throw s},updateToolStatus:async(r,s)=>{const{error:o}=await u.from("tool_integration_status").update({...s,last_checked:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("tool_name",r);if(o)throw o}}},Ya={class:"founder-dashboard"},Va={class:"dashboard-header"},Qa={key:0,class:"active-alerts"},Wa={class:"alerts-badge"},Ga={key:0,class:"loading-state"},ja={key:1,class:"dashboard-content"},za={key:0,class:"alerts-section"},Ja={class:"alert-header"},Ka={class:"alert-icon"},Xa={class:"alert-title"},Za={class:"alert-message"},tn={class:"alert-action"},en={class:"alert-actions"},sn=["onClick"],an=["onClick"],nn={class:"platform-revenue-section"},on={class:"monitoring-layer"},rn={class:"decision-support-layer"},ln={class:"two-column-grid"},cn={class:"operations-layer"},un={class:"revenue-layer"},dn={class:"two-column-grid"},_n=q({__name:"dashboard",setup(u){const{getActiveAlerts:$,acknowledgeAlert:a,resolveAlert:b}=Ha(),p=T([]),l=T(!0),n=async s=>{await a(s),p.value=await $()},r=async s=>{await b(s),p.value=await $()};return A(async()=>{p.value=await $(),l.value=!1}),(s,o)=>{const c=It,g=re,h=fe,v=Ee,y=os,D=Ls,w=va,S=Ua;return _(),m("div",Ya,[t("div",Va,[o[0]||(o[0]=t("h1",null,"Founder Dashboard",-1)),o[1]||(o[1]=t("p",{class:"dashboard-subtitle"},"Single-screen monitoring view for fast decisions",-1)),e(p).length>0?(_(),m("div",Qa,[t("span",Wa,i(e(p).length)+" "+i(e(p).length===1?"Alert":"Alerts"),1)])):k("",!0)]),e(l)?(_(),m("div",Ga,[...o[2]||(o[2]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading dashboard...",-1)])])):(_(),m("div",ja,[e(p).length>0?(_(),m("section",za,[(_(!0),m(I,null,B(e(p),C=>(_(),m("div",{key:C.id,class:R(["alert-item",`severity-${C.severity}`])},[t("div",Ja,[t("span",Ka,i(C.severity==="critical"?"⚠":C.severity==="warning"?"⚡":"ℹ"),1),t("span",Xa,i(C.title),1)]),t("p",Za,i(C.message),1),t("p",tn,[o[3]||(o[3]=t("strong",null,"What to do:",-1)),F(" "+i(C.action_required),1)]),t("div",en,[t("button",{onClick:E=>n(C.id),class:"alert-button"},"Acknowledge",8,sn),t("button",{onClick:E=>r(C.id),class:"alert-button primary"},"Resolve",8,an)])],2))),128))])):k("",!0),t("section",nn,[N(c)]),t("section",on,[N(g),N(h)]),t("section",rn,[t("div",ln,[N(v),N(y)])]),t("section",cn,[N(D)]),t("section",un,[t("div",dn,[N(w),t("div",null,[N(S)])])])]))])}}}),gn=P(_n,[["__scopeId","data-v-4b2a9d8d"]]);export{gn as default};
